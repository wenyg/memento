---
alwaysApply: true
description: Memento 项目结构和架构指南
---

# Memento 项目结构指南

## 项目概述
Memento 是一个轻量级 Markdown 笔记管理 VSCode 扩展，支持多视图、标签分类、工作周报等功能。

## 核心文件结构
- [src/extension.ts](mdc:src/extension.ts) - 主扩展文件，包含所有核心逻辑
- [package.json](mdc:package.json) - 扩展配置和依赖管理
- [tsconfig.json](mdc:tsconfig.json) - TypeScript 编译配置

## 主要组件架构

### 1. 数据提供者 (TreeDataProvider)
- `MdFilesProvider` - 文件列表视图，按创建时间排序
- `TagTreeProvider` - 标签树视图，支持层级标签
- `CalendarProvider` - 日历视图，管理日记和周报
- `MainTreeProvider` - 主视图控制器，切换不同模式

### 2. 数据模型
- `MdFileInfo` - Markdown 文件信息接口
- `FrontMatter` - Front Matter 数据结构
- `TagInfo` - 标签信息结构
- `MementoConfig` - 配置接口

### 3. 视图模式
- `ViewMode.FILES` - 文件视图
- `ViewMode.TAGS` - 标签视图  
- `ViewMode.CALENDAR` - 日历视图
- `ViewMode.SETTINGS` - 设置视图

## 核心功能模块

### 文件管理
- 扫描 Markdown 文件（支持排除文件夹）
- 提取 Front Matter 信息
- 解析标题和标签
- 按时间排序显示

### 标签系统
- 支持 Front Matter 中的 tags 字段
- 支持正文中的 #标签 格式
- 层级标签支持（如 #工作/项目）
- 自动构建标签树结构

### 配置管理
- VSCode 设置集成（memento.notesPath）
- 本地配置文件（.memento/config.json）
- 默认配置和用户配置合并

### 模板系统
- 日记模板（支持日期变量）
- 周报模板（支持周数变量）
- 自定义模板路径支持
- 变量替换功能

## 开发注意事项
1. 所有异步操作都需要错误处理
2. 文件操作前检查路径有效性
3. 配置更新后需要刷新视图
4. 支持相对路径和绝对路径
5. 遵循 VSCode 扩展 API 最佳实践